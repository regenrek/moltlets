---
title: GitHub token
description: Create and validate GITHUB_TOKEN for Clawlets setup.
---

Clawlets uses <code>GITHUB_TOKEN</code> during setup to prove access to the repository
that Nix uses as the base flake source, and to fetch GitHub-hosted flake inputs during
bootstrap/update runs.

You can think in two repos:

- **Project repo**: created by <code>clawlets project init</code>; contains
  <code>fleet/clawlets.json</code>, <code>flake.nix</code>, and <code>secrets/</code>.
- **Base flake repo**: the repo Nix reads from. Usually this is the same project
  repo, unless you set <code>baseFlake</code> to a different GitHub repo.

Clawlets does not create a separate bootstrap repo. If this is your first setup, there is
typically only the project repo unless you intentionally override <code>baseFlake</code>.

If the base flake repo is private, the Setup <code>Provider Tokens</code> step stays blocked
until the token can authenticate.

That token lets the runner:

- verify GitHub API visibility for your base flake repo, and
- pass a GitHub access token to Nix when it evaluates/pulls `github:` flake inputs.

Even on a public repo this token is used by setup to keep a single credential model and
avoid run-time surprises. For private repos, it is required.

Which repository is it checking?

`GITHUB_TOKEN` is checked against the base flake repo in this order:

- `fleet/clawlets.json` field `baseFlake` when it is set (for example `github:owner/repo`)
- the current repo's `origin` remote when `baseFlake` is empty

For projects created by `clawlets project init`, this usually points to the same repository
where you keep `fleet/clawlets.json` and `secrets/`.

Quick checks:

```bash
cat fleet/clawlets.json | sed -n '1,120p'  # check baseFlake
git remote get-url origin                  # check origin fallback
```

Use this page as the canonical operator flow for creating the token and saving it in the dashboard.

## Prereqs

- GitHub account with read access to your base flake repository.
- Base flake source is in <code>fleet/clawlets.json</code> field <code>baseFlake</code> (fallback is git origin).
- Project setup route open in dashboard: <code>/$projectSlug/hosts/$host/setup?step=creds</code>.
- Preferred: a fine-grained personal access token (PAT).

## Create token (recommended: fine-grained PAT)

<Steps>
  <Step>
    Open GitHub token settings:
    <br />
    https://github.com/settings/personal-access-tokens/new
  </Step>
  <Step>
    Set a clear token name (example: <code>clawlets-setup</code>) and a reasonable expiration.
  </Step>
  <Step>
    Under <strong>Resource owner</strong>, select the owner that contains your base flake repository.
    If the repo is in an org, pick that org (not your personal account).
  </Step>
  <Step>
    Under <strong>Repository access</strong>, select <strong>Only select repositories</strong>.
    Then under <strong>Selected repositories</strong>, select exactly the base flake repo Clawlets reads.
  </Step>
  <Step>
    Under <strong>Permissions</strong>, set exactly:
    <br />
    <code>Repository permissions → Contents: Read-only</code>
    <br />
    <code>Repository permissions → Metadata: Read-only</code> (if shown; GitHub may auto-set this)
    <br />
    Leave all other repository, organization, and account permissions at <strong>No access</strong>.
  </Step>
  <Step>
    Create the token and copy it immediately (GitHub shows it once).
  </Step>
</Steps>

For Clawlets setup/deploy, no write permission is needed on GitHub for this token.

If your organization policy blocks fine-grained PATs, use a classic PAT as fallback and grant only what your repository access requires.

## Save token in Clawlets

<Steps>
  <Step>
    Open <code>/$projectSlug/security/api-keys</code>.
  </Step>
  <Step>
    Set <code>GITHUB_TOKEN</code> and save.
  </Step>
  <Step>
    Return to Setup and confirm <code>Provider Tokens</code> is complete.
  </Step>
</Steps>

Related: [Deploy credentials](/dashboard/deploy-credentials)

## Verify

- Setup <code>Provider Tokens</code> no longer blocks on <code>GITHUB_TOKEN</code>.
- Optional CLI check:

```bash
clawlets env show --json
```

## Troubleshooting

### `base flake repo appears private (404). Set GITHUB_TOKEN in your environment and retry.`

- Token is missing, expired, or lacks access to the target repo.
- Reissue token and confirm repository access includes the base flake repo.

### `GITHUB_TOKEN rejected by GitHub (401).`

- Token value is invalid/revoked, or copied with trailing whitespace.
- Regenerate token and paste again.

### Setup still says token missing

- Reopen <code>/$projectSlug/security/api-keys</code> and verify <code>GITHUB_TOKEN</code> is marked as set.
- Save again, then refresh Setup.
