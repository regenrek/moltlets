---
title: Deploy credentials
description: Manage local deploy creds with sealed runner input.
---

Deploy credentials are local-only operator tokens in `<runtimeDir>/env`. They are used by
bootstrap, infra commands, and doctor checks. They are not stored in Convex as secret
values.

UI route: `/<projectSlug>/security/api-keys`

## Keys managed in the UI

- `HCLOUD_TOKEN` (Hetzner, recommended path)
- `GITHUB_TOKEN` (required for Setup deploy and private base repos)
- `SOPS_AGE_KEY_FILE` (advanced/troubleshooting)

## Recommended flow

<Steps>
  <Step>
    Open Project credentials at <code>/$projectSlug/security/api-keys</code>.
  </Step>
  <Step>
    Set `HCLOUD_TOKEN` and `GITHUB_TOKEN`.
  </Step>
  <Step>
    Optional: use `SOPS_AGE_KEY_FILE` only for manual recovery flows outside setup.
  </Step>
</Steps>

Get Hetzner API token:
[Hetzner token setup](/dashboard/hetzner-token)

Get GitHub token:
[GitHub token setup](/dashboard/github-token)

Set SOPS age key:
[SOPS age key setup](/dashboard/sops-age-key)

## Browser to runner sealed-input path

When you click Save, the dashboard uses a reserve+finalize flow:

1. Select a target runner (required when multiple sealed-capable runners are online).
2. Reserve a job targeted to that one online sealed-capable runner.
3. Encrypt deploy-cred JSON in the browser with the selected runner public key.
4. Finalize enqueue with ciphertext only.

Transport invariants:

- Control plane stores ciphertext only (`sealedInputB64`).
- Runner decrypts with its private key at execution time.
- Runner never prompts and never waits for out-of-band secret submit.
- AAD binds ciphertext to `projectId:jobId:kind:targetRunnerId`.

For runner capability details: [Runner Agent](/operations/runner-agent).

## What Convex stores for this flow

Convex stores coordination metadata for deploy-credentials operations:

- runner/job metadata (target runner, run/job ids, status)
- sealed input envelope metadata for queued sealed jobs
- audit metadata (`updatedKeys`, `targetRunnerId`, run references)

In setup flow, Convex also stores draft sealed-section metadata:

- `alg`, `keyId`, `targetRunnerId`, `aad`, `sealedInputB64`, `updatedAt`, `expiresAt`

In setup flow, Convex returns section read status (`set` or `missing`).

Convex does not store plaintext `<runtimeDir>/env` credential values.

## Setup flow behavior

In host Setup, only GitHub token is required from deploy credentials.
`SOPS_AGE_KEY_FILE` is hidden in setup UI:

- Setup entry ensures a host-scoped operator key exists for the active host.
- Deploy re-checks key existence and injects `SOPS_AGE_KEY_FILE` for that host at action time.
- Host-scoped path format:
  `<runtimeDir>/keys/operators/hosts/<host>/<operator>.agekey`.
- Setup readiness does not require manual `SOPS_AGE_KEY_FILE` entry.

## Verify

- In UI, saved keys show status `set`.
- Setup deploy step unlocks once GitHub token and infra/SSH gates pass.
- Optional CLI check via runner:

```bash
clawlets env show --json
```

## Troubleshooting

### "Unable to read deploy creds status. Check runner."

- Runner offline, unreachable, or not paired with project.
- Start/restart runner and re-open the page.

### "No online runner advertises sealed input"

- Runner version is old or heartbeat capabilities are incomplete.
- Restart with latest CLI and confirm runner heartbeat reports sealed-input capability.

### "Select a sealed-capable runner"

- Multiple runners are online and no target runner is selected in the UI.
- Pick one runner in the **Target runner** selector and save again.

### Credentials still unset in Setup

- Confirm required key is set: `GITHUB_TOKEN`
- Confirm Hetzner token is active in setup.
- If deploy fails on internal SOPS preparation, rerun with runner online and check
  [SOPS age key setup](/dashboard/sops-age-key) for recovery.
