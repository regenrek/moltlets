---
title: Setup
description: Guided first deploy checklist.
---

Setup is a command center for getting a new project to its first successful deploy.
Setup is derived from desired state for this host (pending edits + setup draft + config fallback),
so you can stop halfway and resume later without split-brain gating.
Step saves persist as setup drafts. Runner execution happens once at deploy time via a single
sealed `setup_apply` job.

<Callout type="info" title="Runner setup happens before host setup">
  Project creation and runner setup are completed first. This setup flow starts at host onboarding.
  Keep the runner online for config probes, sealed-save actions, and final apply/deploy jobs.
  See [Runner Agent](/operations/runner-agent).
</Callout>

## Where to start

Open:

- Setup: `http://localhost:3000/<projectSlug>/setup`
- Deploy (global chooser): `http://localhost:3000/<projectSlug>/~/deploy`
- Deploy (host): `http://localhost:3000/<projectSlug>/hosts/<host>/deploy`

## Flow

<Steps>
  <Step>
    <strong>Hetzner setup</strong>
    <br />
    Set <code>HCLOUD_TOKEN</code> and confirm Hetzner host defaults:
    <code>serverType</code>, <code>location</code>, optional <code>image</code>, and
    <code>allowTailscaleUdpIngress</code>.
  </Step>
  <Step>
    <strong>Server Access</strong>
    <br />
    Fill <code>provisioning.adminCidr</code> and add at least one SSH key to{" "}
    <code>fleet.sshAuthorizedKeys</code>. You can add keys inline in Setup or from [SSH keys](/dashboard/ssh-keys).
  </Step>
  <Step>
    <strong>Provider Tokens</strong>
    <br />
    Configure remaining local-only credentials in <code>.clawlets/env</code>.
    Complete them via [Deploy credentials](/dashboard/deploy-credentials).{" "}
    Setup uses <code>GITHUB_TOKEN</code> to access the repo where Nix evaluates flakes.
    For Dashboard-created projects, this is usually the local project repo's <code>origin</code> remote and is not a separate
    Clawlets bootstrap repo.
    Save provider credentials as sealed setup draft data.
    <code>GITHUB_TOKEN</code> is required for private repos and optional for public repos.
    The evaluation source is:

    - <code>fleet/clawlets.json</code> → <code>baseFlake</code> (advanced override)
    - otherwise the project repo <code>origin</code> remote
  </Step>
  <Step>
    <strong>Server Passwords</strong>
    <br />
    Enter bootstrap secrets and save them as write-only sealed draft values.
    Values are not shown again after save; status returns as <code>set</code>/<code>missing</code>.
  </Step>
  <Step>
    <strong>Install Server</strong>
    <br />
    Deploy first runs one sealed <code>setup_apply</code> job (config + deploy creds + bootstrap secrets),
    then runs bootstrap.
  </Step>
  <Step>
    <strong>Secure and Verify</strong>
    <br />
    Run the post-bootstrap checklist (tailnet switch, SSH lockdown) and confirm the host is stable.
  </Step>
</Steps>

## What setup stores in Convex

Setup uses Convex as resumable draft state for this host:

Non-secret draft fields:

- `nonSecretDraft.infrastructure.serverType`
- `nonSecretDraft.infrastructure.image`
- `nonSecretDraft.infrastructure.location`
- `nonSecretDraft.infrastructure.allowTailscaleUdpIngress`
- `nonSecretDraft.connection.adminCidr`
- `nonSecretDraft.connection.sshExposureMode`
- `nonSecretDraft.connection.sshKeyCount`
- `nonSecretDraft.connection.sshAuthorizedKeys`

Sealed secret section metadata:

- `alg`, `keyId`, `targetRunnerId`, `aad`, `sealedInputB64`, `updatedAt`, `expiresAt`

Read-side status projection:

- `sealedSecretDrafts.deployCreds.status`
- `sealedSecretDrafts.bootstrapSecrets.status`

Setup readiness checks read these draft status fields (`set`/`missing`).
If no draft secret section exists yet, setup shows missing until you save that section.

Convex does not store plaintext values for deploy credentials or bootstrap secrets.

## Verify

You are “done” when:

- Deploy shows an initial install that completed successfully for the host.
- The post-bootstrap checklist is green (or you have consciously accepted the remaining risk).
- Follow-up Deploy runs apply changes cleanly.

After this, continue with OpenClaw app-layer setup:

- [OpenClaw setup](/dashboard/openclaw-setup)
- [How Clawlets works](/dashboard/how-clawlets-works)

## Troubleshooting

### Setup says “project setup in progress”

The project init run has not finished yet. Open Runs and wait for it to succeed:

- `/<projectSlug>/runs`

### Secrets step won’t complete

Setup requires saving the sealed secret draft for the selected host.
Re-open the Secrets step, replace missing values, and click <strong>Save & Continue</strong>.

### Token already exists locally but setup shows missing

Setup step status is draft-based. If the setup draft for this host does not have the
sealed deploy-credentials section yet, the step shows `HCLOUD_TOKEN` as missing.
Save the token in setup once to mark the draft section as set.

### Deploy says credentials missing

Open Setup → Pre-Deploy (and Hetzner setup for <code>HCLOUD_TOKEN</code>) and save provider tokens.
In setup mode, readiness is draft-first and apply happens only during <code>setup_apply</code>.

Recommended path:

- Save `HCLOUD_TOKEN` (Hetzner): [Hetzner token setup](/dashboard/hetzner-token)
- Save `GITHUB_TOKEN`: [GitHub token setup](/dashboard/github-token)
- Save `SOPS_AGE_KEY_FILE`: [SOPS age key setup](/dashboard/sops-age-key)
- See provider docs: [Hetzner](/providers/hetzner)
