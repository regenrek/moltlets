---
title: POC criteria
description: Definition of done.
---

This POC is about proving that Clawlets can provision and operate a single Hetzner
host end-to-end without manual secret handling or undocumented drift. The checklist
below is the minimum bar before broader rollout.

## Acceptance criteria (must pass)

### Provision + install

The provisioning flow must complete with all required files generated by the CLI:

- `fleet/clawlets.json` exists (schemaVersion 18) and is the single source of truth for fleet + hosts.
- `CLAWLETS_INTERACTIVE=1 clawlets secrets init` created/updated:
  - `secrets/.sops.yaml`
  - `secrets/keys/hosts/<host>.agekey.yaml` (encrypted host age key)
  - `secrets/hosts/<host>/*.yaml` (one secret per file; encrypted)
  - `.clawlets/keys/operators/<operator>.agekey` (local operator key; never committed)
  - `.clawlets/extra-files/<host>/var/lib/sops-nix/key.txt`
  - `.clawlets/extra-files/<host>/var/lib/clawlets/secrets/hosts/<host>/*.yaml`
- `clawlets doctor --scope bootstrap` passes.
- `clawlets env init` completed and `HCLOUD_TOKEN` set.
- `clawlets bootstrap` succeeds.

### Post-install validation

Once the host is up, verify secrets, services, and basic routing.

- SSH works: `ssh admin@<ipv4>` (or your SSH alias).
- Secrets are out-of-store:
  - encrypted secrets exist at `/var/lib/clawlets/secrets/hosts/<host>/`
  - decrypted runtime material exists under `/run/secrets/`
- Services are healthy:
  - `systemctl status 'openclaw-*' --no-pager`
  - expected gateways are running (per `fleet/clawlets.json`).
- Discord routing works (the gateway responds in expected channels).

### Lockdown (no public SSH)

Lockdown confirms tailnet-only access and removes public SSH exposure.

- Tailnet works (Tailscale).
- `clawlets doctor --scope updates --strict` passes.
- `clawlets host set --target-host admin@<tail-ip>` + `clawlets host set --ssh-exposure tailnet` then `clawlets lockdown` succeeds.
- Public SSH closed:
  - Hetzner firewall removes TCP/22 from internet
  - NixOS only allows SSH via `tailscale0` when `sshExposure.mode=tailnet`

### Day-2 ops

Routine operations should work predictably on a live host.

- Apply updates: `clawlets server update apply --host <host>` works.
- Rotate a Discord token:
  - edit `secrets/hosts/<host>/discord_token_<gatewayId>.yaml` with `sops`
  - `clawlets secrets sync`
  - deploy pinned; gateway uses new token
- Roll back by deploying an older commit SHA (pinned) and confirm gateway still runs.

## Non-goals

These are explicitly out of scope for the POC:

- Multi-host fleet orchestration
- CI-driven cache/signing infra (Attic)
